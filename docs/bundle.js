"use strict";(()=>{var j,g,se,Ae,N,ie,ue,de,fe,q,P,K,Re,W={},pe=[],Qe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,z=Array.isArray;function Z(t,e){for(var n in e)t[n]=e[n];return t}function ee(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function We(t,e,n){var o,i,r,l={};for(r in e)r=="key"?o=e[r]:r=="ref"?i=e[r]:l[r]=e[r];if(arguments.length>2&&(l.children=arguments.length>3?j.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)l[r]===void 0&&(l[r]=t.defaultProps[r]);return D(t,l,o,i,null)}function D(t,e,n,o,i){var r={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++se,__i:-1,__u:0};return i==null&&g.vnode!=null&&g.vnode(r),r}function A(t){return t.children}function O(t,e){this.props=t,this.context=e}function B(t,e){if(e==null)return t.__?B(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?B(t):null}function be(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return be(t)}}function ce(t){(!t.__d&&(t.__d=!0)&&N.push(t)&&!T.__r++||ie!=g.debounceRendering)&&((ie=g.debounceRendering)||ue)(T)}function T(){for(var t,e,n,o,i,r,l,a=1;N.length;)N.length>a&&N.sort(de),t=N.shift(),a=N.length,t.__d&&(n=void 0,o=void 0,i=(o=(e=t).__v).__e,r=[],l=[],e.__P&&((n=Z({},o)).__v=o.__v+1,g.vnode&&g.vnode(n),te(e.__P,n,o,e.__n,e.__P.namespaceURI,32&o.__u?[i]:null,r,i??B(o),!!(32&o.__u),l),n.__v=o.__v,n.__.__k[n.__i]=n,he(r,n,l),o.__e=o.__=null,n.__e!=i&&be(n)));T.__r=0}function ge(t,e,n,o,i,r,l,a,s,c,d){var _,f,u,p,v,I,m,b=o&&o.__k||pe,k=e.length;for(s=Me(n,e,b,s,k),_=0;_<k;_++)(u=n.__k[_])!=null&&(f=u.__i==-1?W:b[u.__i]||W,u.__i=_,I=te(t,u,f,i,r,l,a,s,c,d),p=u.__e,u.ref&&f.ref!=u.ref&&(f.ref&&ne(f.ref,null,u),d.push(u.ref,u.__c||p,u)),v==null&&p!=null&&(v=p),(m=!!(4&u.__u))||f.__k===u.__k?s=me(u,s,t,m):typeof u.type=="function"&&I!==void 0?s=I:p&&(s=p.nextSibling),u.__u&=-7);return n.__e=v,s}function Me(t,e,n,o,i){var r,l,a,s,c,d=n.length,_=d,f=0;for(t.__k=new Array(i),r=0;r<i;r++)(l=e[r])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=t.__k[r]=D(null,l,null,null,null):z(l)?l=t.__k[r]=D(A,{children:l},null,null,null):l.constructor===void 0&&l.__b>0?l=t.__k[r]=D(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):t.__k[r]=l,s=r+f,l.__=t,l.__b=t.__b+1,a=null,(c=l.__i=Ye(l,n,s,_))!=-1&&(_--,(a=n[c])&&(a.__u|=2)),a==null||a.__v==null?(c==-1&&(i>d?f--:i<d&&f++),typeof l.type!="function"&&(l.__u|=4)):c!=s&&(c==s-1?f--:c==s+1?f++:(c>s?f--:f++,l.__u|=4))):t.__k[r]=null;if(_)for(r=0;r<d;r++)(a=n[r])!=null&&(2&a.__u)==0&&(a.__e==o&&(o=B(a)),ve(a,a));return o}function me(t,e,n,o){var i,r;if(typeof t.type=="function"){for(i=t.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=t,e=me(i[r],e,n,o));return e}t.__e!=e&&(o&&(e&&t.type&&!e.parentNode&&(e=B(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ye(t,e,n,o){var i,r,l,a=t.key,s=t.type,c=e[n],d=c!=null&&(2&c.__u)==0;if(c===null&&a==null||d&&a==c.key&&s==c.type)return n;if(o>(d?1:0)){for(i=n-1,r=n+1;i>=0||r<e.length;)if((c=e[l=i>=0?i--:r++])!=null&&(2&c.__u)==0&&a==c.key&&s==c.type)return l}return-1}function le(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Qe.test(e)?n:n+"px"}function Y(t,e,n,o,i){var r,l;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||le(t.style,e,"");if(n)for(e in n)o&&n[e]==o[e]||le(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(fe,"$1")),l=e.toLowerCase(),e=l in t||e=="onFocusOut"||e=="onFocusIn"?l.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?o?n.u=o.u:(n.u=q,t.addEventListener(e,r?K:P,r)):t.removeEventListener(e,r?K:P,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function ae(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=q++;else if(e.t<n.u)return;return n(g.event?g.event(e):e)}}}function te(t,e,n,o,i,r,l,a,s,c){var d,_,f,u,p,v,I,m,b,k,J,C,w,F,X,U,G,V=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(s=!!(32&n.__u),r=[a=e.__e=n.__e]),(d=g.__b)&&d(e);e:if(typeof V=="function")try{if(m=e.props,b="prototype"in V&&V.prototype.render,k=(d=V.contextType)&&o[d.__c],J=d?k?k.props.value:d.__:o,n.__c?I=(_=e.__c=n.__c).__=_.__E:(b?e.__c=_=new V(m,J):(e.__c=_=new O(m,J),_.constructor=V,_.render=Oe),k&&k.sub(_),_.state||(_.state={}),_.__n=o,f=_.__d=!0,_.__h=[],_._sb=[]),b&&_.__s==null&&(_.__s=_.state),b&&V.getDerivedStateFromProps!=null&&(_.__s==_.state&&(_.__s=Z({},_.__s)),Z(_.__s,V.getDerivedStateFromProps(m,_.__s))),u=_.props,p=_.state,_.__v=e,f)b&&V.getDerivedStateFromProps==null&&_.componentWillMount!=null&&_.componentWillMount(),b&&_.componentDidMount!=null&&_.__h.push(_.componentDidMount);else{if(b&&V.getDerivedStateFromProps==null&&m!==u&&_.componentWillReceiveProps!=null&&_.componentWillReceiveProps(m,J),e.__v==n.__v||!_.__e&&_.shouldComponentUpdate!=null&&_.shouldComponentUpdate(m,_.__s,J)===!1){for(e.__v!=n.__v&&(_.props=m,_.state=_.__s,_.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(H){H&&(H.__=e)}),C=0;C<_._sb.length;C++)_.__h.push(_._sb[C]);_._sb=[],_.__h.length&&l.push(_);break e}_.componentWillUpdate!=null&&_.componentWillUpdate(m,_.__s,J),b&&_.componentDidUpdate!=null&&_.__h.push(function(){_.componentDidUpdate(u,p,v)})}if(_.context=J,_.props=m,_.__P=t,_.__e=!1,w=g.__r,F=0,b){for(_.state=_.__s,_.__d=!1,w&&w(e),d=_.render(_.props,_.state,_.context),X=0;X<_._sb.length;X++)_.__h.push(_._sb[X]);_._sb=[]}else do _.__d=!1,w&&w(e),d=_.render(_.props,_.state,_.context),_.state=_.__s;while(_.__d&&++F<25);_.state=_.__s,_.getChildContext!=null&&(o=Z(Z({},o),_.getChildContext())),b&&!f&&_.getSnapshotBeforeUpdate!=null&&(v=_.getSnapshotBeforeUpdate(u,p)),U=d,d!=null&&d.type===A&&d.key==null&&(U=ye(d.props.children)),a=ge(t,z(U)?U:[U],e,n,o,i,r,l,a,s,c),_.base=e.__e,e.__u&=-161,_.__h.length&&l.push(_),I&&(_.__E=_.__=null)}catch(H){if(e.__v=null,s||r!=null)if(H.then){for(e.__u|=s?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,e.__e=a}else{for(G=r.length;G--;)ee(r[G]);$(e)}else e.__e=n.__e,e.__k=n.__k,H.then||$(e);g.__e(H,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=De(n.__e,e,n,o,i,r,l,s,c);return(d=g.diffed)&&d(e),128&e.__u?void 0:a}function $(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach($)}function he(t,e,n){for(var o=0;o<n.length;o++)ne(n[o],n[++o],n[++o]);g.__c&&g.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(r){r.call(i)})}catch(r){g.__e(r,i.__v)}})}function ye(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:z(t)?t.map(ye):Z({},t)}function De(t,e,n,o,i,r,l,a,s){var c,d,_,f,u,p,v,I=n.props||W,m=e.props,b=e.type;if(b=="svg"?i="http://www.w3.org/2000/svg":b=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(c=0;c<r.length;c++)if((u=r[c])&&"setAttribute"in u==!!b&&(b?u.localName==b:u.nodeType==3)){t=u,r[c]=null;break}}if(t==null){if(b==null)return document.createTextNode(m);t=document.createElementNS(i,b,m.is&&m),a&&(g.__m&&g.__m(e,r),a=!1),r=null}if(b==null)I===m||a&&t.data==m||(t.data=m);else{if(r=r&&j.call(t.childNodes),!a&&r!=null)for(I={},c=0;c<t.attributes.length;c++)I[(u=t.attributes[c]).name]=u.value;for(c in I)if(u=I[c],c!="children"){if(c=="dangerouslySetInnerHTML")_=u;else if(!(c in m)){if(c=="value"&&"defaultValue"in m||c=="checked"&&"defaultChecked"in m)continue;Y(t,c,null,u,i)}}for(c in m)u=m[c],c=="children"?f=u:c=="dangerouslySetInnerHTML"?d=u:c=="value"?p=u:c=="checked"?v=u:a&&typeof u!="function"||I[c]===u||Y(t,c,u,I[c],i);if(d)a||_&&(d.__html==_.__html||d.__html==t.innerHTML)||(t.innerHTML=d.__html),e.__k=[];else if(_&&(t.innerHTML=""),ge(e.type=="template"?t.content:t,z(f)?f:[f],e,n,o,b=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,l,r?r[0]:n.__k&&B(n,0),a,s),r!=null)for(c=r.length;c--;)ee(r[c]);a||(c="value",b=="progress"&&p==null?t.removeAttribute("value"):p!=null&&(p!==t[c]||b=="progress"&&!p||b=="option"&&p!=I[c])&&Y(t,c,p,I[c],i),c="checked",v!=null&&v!=t[c]&&Y(t,c,v,I[c],i))}return t}function ne(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(i){g.__e(i,n)}}function ve(t,e,n){var o,i;if(g.unmount&&g.unmount(t),(o=t.ref)&&(o.current&&o.current!=t.__e||ne(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(r){g.__e(r,e)}o.base=o.__P=null}if(o=t.__k)for(i=0;i<o.length;i++)o[i]&&ve(o[i],e,n||typeof t.type!="function");n||ee(t.__e),t.__c=t.__=t.__e=void 0}function Oe(t,e,n){return this.constructor(t,n)}function xe(t,e,n){var o,i,r,l;e==document&&(e=document.documentElement),g.__&&g.__(t,e),i=(o=typeof n=="function")?null:n&&n.__k||e.__k,r=[],l=[],te(e,t=(!o&&n||e).__k=We(A,null,[t]),i||W,W,e.namespaceURI,!o&&n?[n]:i?null:e.firstChild?j.call(e.childNodes):null,r,!o&&n?n:i?i.__e:e.firstChild,o,l),he(r,t,l)}j=pe.slice,g={__e:function(t,e,n,o){for(var i,r,l;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(t)),l=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,o||{}),l=i.__d),l)return i.__E=i}catch(a){t=a}throw t}},se=0,Ae=function(t){return t!=null&&t.constructor===void 0},O.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Z({},this.state),typeof t=="function"&&(t=t(Z({},n),this.props)),t&&Z(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ce(this))},O.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ce(this))},O.prototype.render=A,N=[],ue=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,de=function(t,e){return t.__v.__b-e.__v.__b},T.__r=0,fe=/(PointerCapture)$|Capture$/i,q=0,P=ae(!1),K=ae(!0),Re=0;var M,y,oe,Ie,S=0,Ze=[],x=g,ke=x.__b,Ce=x.__r,Fe=x.diffed,Xe=x.__c,we=x.unmount,Ve=x.__;function _e(t,e){x.__h&&x.__h(y,t,S||e),S=0;var n=y.__H||(y.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function R(t){return S=1,Te(Ne,t)}function Te(t,e,n){var o=_e(M++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):Ne(void 0,e),function(a){var s=o.__N?o.__N[0]:o.__[0],c=o.t(s,a);s!==c&&(o.__N=[c,o.__[1]],o.__c.setState({}))}],o.__c=y,!y.__f)){var i=function(a,s,c){if(!o.__c.__H)return!0;var d=o.__c.__H.__.filter(function(f){return!!f.__c});if(d.every(function(f){return!f.__N}))return!r||r.call(this,a,s,c);var _=o.__c.props!==a;return d.forEach(function(f){if(f.__N){var u=f.__[0];f.__=f.__N,f.__N=void 0,u!==f.__[0]&&(_=!0)}}),r&&r.call(this,a,s,c)||_};y.__f=!0;var r=y.shouldComponentUpdate,l=y.componentWillUpdate;y.componentWillUpdate=function(a,s,c){if(this.__e){var d=r;r=void 0,i(a,s,c),r=d}l&&l.call(this,a,s,c)},y.shouldComponentUpdate=i}return o.__N||o.__}function L(t,e){var n=_e(M++,3);!x.__s&&Ge(n.__H,e)&&(n.__=t,n.u=e,y.__H.__h.push(n))}function Ue(t){return S=5,je(function(){return{current:t}},[])}function je(t,e){var n=_e(M++,7);return Ge(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function ze(){for(var t;t=Ze.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(E),t.__H.__h.forEach(re),t.__H.__h=[]}catch(e){t.__H.__h=[],x.__e(e,t.__v)}}x.__b=function(t){y=null,ke&&ke(t)},x.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Ve&&Ve(t,e)},x.__r=function(t){Ce&&Ce(t),M=0;var e=(y=t.__c).__H;e&&(oe===y?(e.__h=[],y.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(E),e.__h.forEach(re),e.__h=[],M=0)),oe=y},x.diffed=function(t){Fe&&Fe(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Ze.push(e)!==1&&Ie===x.requestAnimationFrame||((Ie=x.requestAnimationFrame)||Ee)(ze)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),oe=y=null},x.__c=function(t,e){e.some(function(n){try{n.__h.forEach(E),n.__h=n.__h.filter(function(o){return!o.__||re(o)})}catch(o){e.some(function(i){i.__h&&(i.__h=[])}),e=[],x.__e(o,n.__v)}}),Xe&&Xe(t,e)},x.unmount=function(t){we&&we(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{E(o)}catch(i){e=i}}),n.__H=void 0,e&&x.__e(e,n.__v))};var Je=typeof requestAnimationFrame=="function";function Ee(t){var e,n=function(){clearTimeout(o),Je&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,35);Je&&(e=requestAnimationFrame(n))}function E(t){var e=y,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),y=e}function re(t){var e=y;t.__c=t.__(),y=e}function Ge(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function Ne(t,e){return typeof e=="function"?e(t):e}var Q={token:null,expiresAt:0};async function Se(){try{let t=await fetch("https://ai.liukonen.dev/lease",{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)throw new Error(`Token request failed: ${t.status}`);let e=await t.json();return Q={token:e.token,expiresAt:Date.now()+e.ttl*1e3},Q.token}catch(t){return console.error("Could not get auth token:",t),Q={token:null,expiresAt:0},null}}async function He(){return Q.token&&Date.now()<Q.expiresAt-5e3?Q.token:await Se()}var Le=0;function h(t,e,n,o,i,r){e||(e={});var l,a,s=e;if("ref"in s)for(a in s={},e)a=="ref"?l=e[a]:s[a]=e[a];var c={type:t,props:s,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Le,__i:-1,__u:0,__source:i,__self:r};if(typeof t=="function"&&(l=t.defaultProps))for(a in l)s[a]===void 0&&(s[a]=l[a]);return g.vnode&&g.vnode(c),c}var Pe=()=>{let[t,e]=R([]),[n,o]=R(""),[i,r]=R(0),[l,a]=R(""),[s,c]=R(null),d=Ue(null),_=()=>{let p=i;return r(p+1),p};L(()=>{if(s===null)a("");else{let p=0,v=setInterval(()=>{a(".".repeat(p%3+1)),p++},400);return()=>clearInterval(v)}},[s]);let f=async()=>{if(n.trim()==="")return;let p=i,v=i+1;r(v+1);let I={id:p,text:n,isUser:!0,timestamp:Date.now()},m={id:v,text:"",isUser:!1,timestamp:Date.now(),isTyping:!0};e(C=>[...C,I,m]),c(v);let b=null,k=!1,J=new Promise((C,w)=>{b=setTimeout(()=>{k=!0,e(F=>F.map(X=>X.id===v?{...X,text:"Sorry, the bot did not respond in time.",isTyping:!1}:X)),c(null),w(new Error("Timeout"))},1e4)});try{let C=await He();if(!C){console.warn("Bot not accessible at the moment");return}let w=await fetch(`https://ai.liukonen.dev?text=${encodeURIComponent(n)}`,{headers:{Authorization:`Bearer ${C}`}}),F=await Promise.race([w,J]),X;F instanceof Response?X=await F.json():X=F,k||(e(U=>U.map(G=>G.id===v?{...G,text:X.response,isTyping:!1}:G)),c(null))}catch(C){k||(e(w=>w.map(F=>F.id===v?{...F,text:"Sorry, there was an error getting a response.",isTyping:!1}:F)),c(null)),console.error("Fetch error:",C)}b&&clearTimeout(b),o("")},u=p=>{p.key==="Enter"&&f()};return L(()=>{e(p=>[...p,{id:_(),text:"Welcome to the chatbot!",isUser:!1}])},[]),L(()=>{d.current&&d.current.scroll({top:d.current.scrollHeight,behavior:"smooth"})},[t]),h("div",{class:"container-fluid h-100",id:"app",children:h("div",{class:"row justify-content-center h-100",children:h("div",{class:"col-12 card h-100",children:[h("div",{class:"card-header msg_head",children:h("div",{class:"d-flex bd-highlight justify-content-between",children:[h("div",{class:"user_info",children:[h("span",{children:"River Chatbot"}),h("p",{children:[h("i",{id:"msgCount",children:i})," Messages"]})]}),h("button",{class:"text-light btn","aria-label":"Info","data-bs-toggle":"modal","data-bs-target":"#aboutModal",children:h("i",{class:"fa-solid fa-address-card fa-2x"})})]})}),h("div",{class:"card-body msg_card_body scr",style:{overflow:"auto"},id:"dialogue",ref:d,children:t.map(p=>h("div",{class:`message ${p.isUser?"user-message":""}`,children:h("div",{class:"message-text",children:p.isTyping?h("span",{children:["Bot is typing",h("span",{style:{fontWeight:"bold"},children:l})]}):p.text})},p.id))}),h("div",{class:"card-footer",children:h("div",{class:"input-group",children:[h("span",{class:"input-group-text attach_btn"}),h("input",{class:"input-field form-control type_msg","aria-label":"Input Message",placeholder:"Type your message...",autoComplete:"off",type:"text",value:n,onInput:p=>o(p.target.value),onKeyDown:u}),h("button",{class:"input-group-text send_btn",onClick:f,children:h("i",{class:"fas fa-location-arrow"})})]})})]})})})},Be=Pe;xe(h(Be,{}),document.getElementById("data"));})();
//# sourceMappingURL=bundle.js.map
